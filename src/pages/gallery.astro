---
import BaseLayout from '../layouts/BaseLayout.astro';
import { paintings } from '../data/paintings';

// Split paintings into square-ish (first 15) and irregular (last 4)
const squareish = paintings.slice(0, 15);
const irregular = paintings.slice(15);
---

<BaseLayout title="Portfolio" description="Browse abstract paintings by Kay Breaux Livaudais">
  <section class="px-6 md:px-12 lg:px-20 py-12 md:py-16">
    <div class="max-w-7xl mx-auto">
      <h1 class="font-heading text-[21px] text-warm-700 mb-4 uppercase tracking-wide-3 font-normal text-center">Portfolio</h1>
      <p class="text-warm-400 text-[15px] leading-[28px] mb-12 max-w-2xl mx-auto text-center">
        A collection of abstract paintings exploring color, texture, and emotion.
      </p>

      <!-- Square grid section -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
        {squareish.map((painting) => (
          <div
            class="group cursor-pointer"
            data-painting={JSON.stringify(painting)}
            onclick="openLightbox(this)"
          >
            <div class="aspect-square bg-warm-100 overflow-hidden relative">
              {painting.image ? (
                <img
                  src={painting.image}
                  alt={painting.title}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                  loading="lazy"
                />
              ) : (
                <div class="w-full h-full flex items-center justify-center">
                  <p class="text-warm-400 font-body italic text-sm">{painting.title}</p>
                </div>
              )}
              <div class="absolute inset-0 bg-warm-900/0 group-hover:bg-warm-900/10 transition-colors duration-300" />
            </div>
          </div>
        ))}
      </div>

      <!-- Irregular shapes - full uncropped, stacked below -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6 mt-4 md:mt-6">
        {irregular.map((painting) => (
          <div
            class="group cursor-pointer"
            data-painting={JSON.stringify(painting)}
            onclick="openLightbox(this)"
          >
            <div class="aspect-square bg-warm-100 overflow-hidden relative">
              {painting.image ? (
                <img
                  src={painting.image}
                  alt={painting.title}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                  loading="lazy"
                />
              ) : (
                <div class="aspect-square flex items-center justify-center">
                  <p class="text-warm-400 font-body italic text-sm">{painting.title}</p>
                </div>
              )}
              <div class="absolute inset-0 bg-warm-900/0 group-hover:bg-warm-900/10 transition-colors duration-300" />
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Lightbox Modal - shows full uncropped image -->
  <div id="lightbox" class="fixed inset-0 bg-warm-900/90 z-50 hidden items-center justify-center p-4 md:p-8" onclick="closeLightbox(event)">
    <button
      class="absolute top-6 right-6 text-white/80 hover:text-white text-3xl font-light z-10"
      onclick="closeLightbox(event, true)"
      aria-label="Close"
    >
      âœ•
    </button>
    <div class="max-w-5xl w-full flex items-center justify-center" onclick="event.stopPropagation()">
      <div id="lightbox-image" class="w-full flex items-center justify-center">
        <p class="text-warm-400 font-body italic">Image placeholder</p>
      </div>
    </div>
  </div>

  <script is:inline>
    function openLightbox(el) {
      const painting = JSON.parse(el.dataset.painting);
      const lightbox = document.getElementById('lightbox');

      const imageContainer = document.getElementById('lightbox-image');
      if (painting.image) {
        imageContainer.innerHTML = `<img src="${painting.image}" alt="${painting.title}" class="max-w-full max-h-[90vh] object-contain" />`;
      } else {
        imageContainer.innerHTML = `<p class="text-warm-400 font-body italic">${painting.title}</p>`;
      }

      lightbox.classList.remove('hidden');
      lightbox.classList.add('flex');
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox(event, force) {
      if (force || event.target === document.getElementById('lightbox')) {
        const lightbox = document.getElementById('lightbox');
        lightbox.classList.add('hidden');
        lightbox.classList.remove('flex');
        document.body.style.overflow = '';
      }
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeLightbox(e, true);
    });
  </script>
</BaseLayout>
